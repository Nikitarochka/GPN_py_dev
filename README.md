# README

В этом документе описано, как развернуть сервис на Python (FastAPI + Celery + Redis) и провести нагрузочное тестирование Locust.  
Итоговый отчёт нагрузочного тестирования сохраняется в файл `report.html`.

## Шаг 1. Открытие консоли
1. Установите Docker и Docker Compose (если ещё не установлены).  
2. Перейдите в папку проекта (где находятся файлы `docker-compose.yml`, `Dockerfile`, `locustfile.py`, `wait-for-web.sh` и код приложения) при помощи консоли или терминала.  
   - Пример для Windows:
     cd C:\Users\Acer\Documents\Python\GPN_Py_dev
   - Пример для Linux/Mac:
     cd /home/user/Python/GPN_Py_dev

## Шаг 2. Подготовка окружения
1. Очистите старые контейнеры и сети, чтобы избежать конфликтов:
   ```bash
   docker-compose down --volumes --remove-orphans
Очистите неиспользуемые сети и контейнеры:
   ```bash
    docker network prune
    docker system prune -a
   ```
Действуйте осторожно: docker system prune -a может удалить многие неиспользуемые ресурсы Docker.

## Шаг 3. Сборка и запуск контейнеров
   ```bash
    Запустите сборку и запуск:
    docker-compose up --build -d
   ```
Убедитесь, что контейнеры запустились. Просмотрите список контейнеров:
   ```bash
docker ps
   ```
В выводе должны отобразиться контейнеры веб-сервиса (FastAPI), Redis, Celery, Locust (если он включён в docker-compose.yml).

## Шаг 4. Нагрузочное тестирование (Locust)
Запустите Locust в headless‑режиме (без веб-интерфейса) для генерации отчёта report.html:
   ```bash
docker-compose run --rm locust -f locustfile.py --headless -u 50 -r 10 --run-time 1m --html report.html
   ```
-u 50 — количество виртуальных пользователей.
-r 10 — скорость наращивания нагрузки (пользователей в секунду).
--run-time 1m — время тестирования (1 минута).
--html report.html — итоговый HTML‑отчёт сохранится под именем report.html.
Дождитесь завершения теста. По окончании в корневой директории проекта появится файл report.html.

## Шаг 5. Просмотр результата
Откройте файл report.html в браузере:
Для Windows дважды кликните на файл или откройте его через контекстное меню «Открыть с помощью».
Для Linux/Mac запустите в консоли, указав путь к файлу:
   ```bash
xdg-open report.html
   ```
В отчёте будут показаны графики и статистика по времени отклика, количеству запросов в секунду, проценту ошибок и т.д.
## Шаг 6. Остановка контейнеров
После окончания работы остановите и удалите все контейнеры:
   ```bash
docker-compose down
   ```
Освободите дополнительные ресурсы:
   ```bash
docker system prune -a
   ```
